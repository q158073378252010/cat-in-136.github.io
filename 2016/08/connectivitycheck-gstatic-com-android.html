<!DOCTYPE html>

<html>
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<title>connectivitycheck.gstatic.com ã¸ã® Android ã®æ¥ç¶šã‚’èª¤é­”åŒ–ã—ã¦ã¿ã‚‹ãƒ†ã‚¹ãƒˆ cat_in_136.blog()</title>
<link rel="canonical" href="https://cat-in-136.github.io/2016/08/connectivitycheck-gstatic-com-android.html" />
<link rel="alternate" type="application/atom+xml" href="/feed.xml" />
<meta property="og:title" content="connectivitycheck.gstatic.com ã¸ã® Android ã®æ¥ç¶šã‚’èª¤é­”åŒ–ã—ã¦ã¿ã‚‹ãƒ†ã‚¹ãƒˆ" />
<meta property="og:type" content="article" />
<meta property="og:image" content="/images/201608_connectivitycheck_noinetwifi.png" />
<meta property="og:site_name" content="cat_in_136.blog()" />
<meta name="viewport" content="width=device-width,initial-scale=1.0,max-scale=10,min-scale=0.5,user-scalable=yes" />
<link rel="stylesheet" href="/css/main.css" />
<link rel="stylesheet" href="https://code.cdn.mozilla.net/fonts/fira.css" />
</head>
<body>
<header class="site-header">
<div class="wrap">
<a class="site-title" href="/">cat_in_136.blog()</a>
<nav class="site-nav" role="navigation">
<a class="page-link" href="/archive">Archive</a>
<a class="page-link" href="/feed.xml">Feed</a>
<a class="page-link" href="/tags">Tags</a>
</nav>
</div>
</header>
<div class="page-content" role="main">
<div class="wrap">
<article class="post" itemscope="itemscope" itemtype="http://schema.org/BlogPosting">
<header class="post-header">
<h1 itemprop="name"><a href="/2016/08/connectivitycheck-gstatic-com-android.html" itemprop="url">connectivitycheck.gstatic.com ã¸ã® Android ã®æ¥ç¶šã‚’èª¤é­”åŒ–ã—ã¦ã¿ã‚‹ãƒ†ã‚¹ãƒˆ</a></h1>
<div class="meta">
Text by: <span itemprop="author" itemscope="itemscope" itemtype="http://schema.org/Person"><span itemprop="name">cat_in_136</span></span>
</div>
<div class="meta">
Date: <time itemprop="datePublished">2016-08-15T23:02:54+09:00</time>
</div>
<div class="meta">
Tags:
<a class="tag" href="/tags.html#tag_android">Android</a>
<a class="tag" href="/tags.html#tag_%E3%83%81%E3%83%A9%E3%82%B7%E3%81%AE%E8%A3%8F">ãƒãƒ©ã‚·ã®è£</a>
</div>
</header>
<div class="post-content" itemprop="articleBody" lang="ja">
<h3>Android ã®ã€Œã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã¯åˆ©ç”¨ã§ãã¾ã›ã‚“ã€ã®æ¤œå‡º</h3>
<p>
Android ã«è©³ã—ã„æ–¹ã¯ã”å­˜çŸ¥ã®é€šã‚Šã€Android ã¯
<code>http://connectivitycheck.gstatic.com/generate_204</code>
ã«å®šæœŸçš„ã«æ¥ç¶šã‚’ã—ã¦ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆæ¥ç¶šã§ãã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã—ã¦ã„ã‚‹ã€‚
ã“ã“ã¸ã®æ¥ç¶šãŒå‡ºæ¥ãªã„å ´åˆã¯ã€Œã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã¯åˆ©ç”¨ã§ãã¾ã›ã‚“ã€ã¨è¡¨ç¤ºã•ã‚Œã‚‹ã€‚
</p>
<figure style="display: block; margin: auto; text-align: center; font-size: smaller;">
<img class="fitcontain" src="/images/201608_connectivitycheck_noinetwifi.png" width="640" height="277" />
<figcaption>connectivitycheck.gstatic.com ã¸æ¥ç¶šã§ããªã„æ™‚ã® WiFi ã‚¢ã‚¯ã‚»ã‚¹ãƒã‚¤ãƒ³ãƒˆã®è­¦å‘Šè¡¨ç¤º</figcaption>
</figure>
<p>
ãªãŠã€ã“ã®è­¦å‘Šã¯ celler å›ç·šï¼ˆ3G/4G å›ç·šï¼‰ã§ã‚‚è¡¨ç¤ºã¯ç•°ãªã‚‹ãŒã€è­¦å‘Šã•ã‚Œã‚‹ã€‚
</p>
<figure style="display: block; margin: auto; text-align: center; font-size: smaller;">
<img class="fitcontain" src="/images/201608_connectivitycheck_noinetdocomo.png" width="487" height="487" />
<figcaption>connectivitycheck.gstatic.com ã¸æ¥ç¶šã§ããªã„æ™‚ã® docomo å›ç·šã®è­¦å‘Šè¡¨ç¤º</figcaption>
</figure>
<p>
ãªãŠã€ä¸Šã®å›³ã¯ã„ãšã‚Œã‚‚ connectivitycheck.gstatic.com ã¸ã®æ¥ç¶šã‚’é®æ–­ã—ã¦å¾—ã‚‰ã‚ŒãŸå‹•ä½œçµæœã§ã‚ã‚Šã€
å®Ÿéš›ã«ã¯ä»–ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã¸ã®æ¥ç¶šã¯ã§ãã‚‹ã¨ã„ã£ãŸæŒ™å‹•ã‚’ç¢ºèªã—ã¦ã„ã‚‹ã€‚
</p>
<h3>connectivitycheck.gstatic.com ã®å½è£…ã¨æŒ™å‹•</h3>
<p>
<code>http://connectivitycheck.gstatic.com/generate_204</code>
ã¸æ¥ç¶šã™ã‚‹ã¨å¸¸ã« "204 No Content" ãŒå¸°ã£ã¦ãã‚‹ã€‚
ã“ã“ã§ã€æ¥ç¶šä¸èƒ½ã§ã‚ã£ãŸã‚Š "404 Not Found" ã§ã‚ã£ãŸã‚Šã—ãŸã¨ãã«ã€
ã€Œã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã¯åˆ©ç”¨ã§ãã¾ã›ã‚“ã€ã¨åˆ¤å®šãŒãªã•ã‚Œã‚‹ã€‚
</p>
<p>
ãã“ã§ã€connectivitycheck.gstatic.com ã‚’ä»–ã® IP ã‚¢ãƒ‰ãƒ¬ã‚¹ã«è§£æ±ºã•ã›ã‚‹ã“ã¨ã§
ä»£æ›¿ã™ã‚‹ã“ã¨ã‚’è€ƒãˆãŸã€‚
å…·ä½“çš„ã«ã¯ã€
</p>
<ul>
<li>192.168.1.2 ã‚¢ãƒ‰ãƒ¬ã‚¹ã§èµ·å‹•ã—ã¦ã„ã‚‹ PC ä¸Šã® port 80 ã§ HTTP server ã‚’èµ·å‹•ã•ã›ã‚‹ã€‚
<ul>
<li><code>http://192.168.1.2/generate_204</code> ã¸ã®ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã¯ "204 No Content" ã¨ã™ã‚‹ã€‚</li>
<li>ç°¡å˜ã®ãŸã‚ "Host: connectivitycheck.gstatic.com" ãŒè¦æ±‚ãƒ˜ãƒƒãƒ€ã«ã¤ã„ã¦ã„ã‚ˆã†ãŒã¤ã„ã¦ã„ã¾ã„ãŒã€åŒä¸€ã®å‹•ä½œã‚’ã™ã‚‹ã‚‚ã®ã¨ã™ã‚‹</li>
</ul>
</li>
<li>Android æ©Ÿã«ãŠã„ã¦ã€connectivitycheck.gstatic.com ã®ãƒ‰ãƒ¡ã‚¤ãƒ³åã‚’ 192.168.1.2 ã«è§£æ±ºã•ã›ã‚‹ç’°å¢ƒã‚’ä½œã‚‹ã€‚</li>
<li>Android æ©Ÿã«ãŠã„ã¦ã€WiFi ã‚¢ã‚¯ã‚»ã‚¹ãƒã‚¤ãƒ³ãƒˆã«æ¥ç¶šã•ã›ã‚‹ã€‚Android æ©Ÿã® IP ã‚¢ãƒ‰ãƒ¬ã‚¹ã¯ 192.168.1.1 ã¨ã™ã‚‹ã€‚</li>
</ul>
<figure style="display: block; margin: auto; text-align: center; font-size: smaller;">
<object width="314" height="308" data="/images/201608_connectivitycheck_env_tporogy.svg"></object>
<figcaption>ç¢ºèªç’°å¢ƒã®ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã€‚"genuine connectivitycheck.gstatic.com"ã«ã¯æ¥ç¶šã—ã«ã¯è¡Œã‹ãšã« 192.168.1.2 ã«æ¥ç¶šã™ã‚‹</figcaption>
</figure>
<p>
ç›®çš„ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«ç°¡ç´ ãª HTTP server <a href="https://gist.github.com/cat-in-136/624e53f4b9437c8eaee15066da654485">"Fake connectivitycheck.gstatic.com"</a> ã‚’ä½œæˆã—ãŸã€‚
ã“ã‚Œã‚’ linux ãƒã‚·ãƒ³ä¸Šã§é§†å‹•ã•ã›ãŸï¼ˆã‚‚ã¡ã‚ã‚“ su æ¨©é™ã§å®Ÿè¡Œã—ã€ã¾ãŸ firewall ã§ port 80 ã‚’è¨±å¯ã—ãŸï¼‰ã€‚
</p>
<p>
ãã—ã¦ Android æ©Ÿã‚’ WiFi ã«æ¥ç¶šã•ã›ã‚‹ã¨ä¸‹è¨˜ã®é€šã‚Šã€ HTTP server å´ã®ãƒ­ã‚°ãŒåãå‡ºã•ã‚ŒãŸã€‚
</p>
<pre><samp>[2016-08-14 07:23:00] DEBUG accept: 192.168.1.1:51856
[2016-08-14 07:23:00] DEBUG WEBrick::HTTPServlet::ProcHandler is invoked.
192.168.1.1 - - [14/Aug/2016:07:23:00 EDT] "GET /generate_204 HTTP/1.1" 204 0
- -&gt; /generate_204
Dalvik/2.1.0 (Linux; U; Android 6.0.1; Nexus 5 Build/MMB29X)
[2016-08-14 07:23:00] DEBUG close: 192.168.1.1:51856
[2016-08-14 07:23:01] DEBUG accept: 192.168.1.1:56927
[2016-08-14 07:23:01] DEBUG WEBrick::HTTPServlet::ProcHandler is invoked.
192.168.1.1 - - [14/Aug/2016:07:23:01 EDT] "GET /generate_204 HTTP/1.1" 204 0
- -&gt; /generate_204
Dalvik/2.1.0 (Linux; U; Android 6.0.1; Nexus 5 Build/MMB29X)
[2016-08-14 07:23:01] DEBUG close: 192.168.1.1:56927</samp></pre>
<p>
æœ€åˆã®éƒ¨åˆ†ã—ã‹å–ã‚Šå‡ºã—ã¦ã„ãªã„ãŸã‚æ™‚é–“ã‚’ç©ºã‘ãšã«å¹¾åº¦ã‚‚æ¥ç¶šã—ã¦ã„ã‚‹ã‚ˆã†ã«ã¿ãˆã‚‹ãŒã€
ã—ã°ã‚‰ãçµŒã£ãŸã‚‰é–“éš”ã‚’ã‚ã‘ã¦æ¥ç¶šã™ã‚‹ã‚ˆã†ã ã€‚
ã¾ãŸã€é‡è¦ãªã“ã¨ã¨ã—ã¦ã“ã‚Œã«ã‚ˆã£ã¦ã€Œã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã¯åˆ©ç”¨ã§ãã¾ã›ã‚“ã€ãŒè¡¨ç¤ºã•ã‚Œãªã„ã“ã¨ã‚’å®Ÿç¾ã§ããŸã€‚
</p>
<h3>connectivitycheck.gstatic.com ã®å½è£…åŠ¹æœ</h3>
<p>
<a href="http://connectivitycheck.gstatic.com.ipaddress.com/"><code>connectivitycheck.gstatic.com</code> ã¨ã„ã†Google ã®ã‚µãƒ¼ãƒ</a>ã¸ã®æ¥ç¶šå‡¦ç†ã¯ã€
ãã‚‚ãã‚‚ Android ã®ã‚³ãƒ¼ãƒ‰ã«åŸ‹ã‚è¾¼ã¾ã‚Œã¦ã„ã‚‹ã€‚
ã‚ˆã£ã¦<em>ä¸–ç•Œä¸­ã®</em>ã‚ªãƒ³ãƒ©ã‚¤ãƒ³ã¨ãªã£ã¦ã„ã‚‹ Android æ©Ÿã‹ã‚‰å®šæœŸçš„ã«æ¥ç¶šã—ã¦ã„ã‚‹ã¨ã„ã†ã“ã¨ã ã€‚
ãã‚Œã¯å†·é™ã«è€ƒãˆã‚‹ã¨èˆˆå‘³æ·±ã„ã“ã¨ã§ã‚ã‚‹ã€‚
<code>connectivitycheck.gstatic.com</code> ã®æ¥ç¶šã‚’
æœ¬ç¨¿ã§è¿°ã¹ãŸã‚ˆã†ã«ã‚´ãƒ‹ãƒ§ã‚´ãƒ‹ãƒ§ã™ã‚‹ã“ã¨ã§ã“ã® Google ã®ã‚µãƒ¼ãƒã¸ã®æ¥ç¶šå‡¦ç†ã‚’æ­¢ã‚ã¦
ã‹ã¤ã€Œã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã¯åˆ©ç”¨ã§ãã¾ã›ã‚“ã€åˆ¤å®šã‚‚ Google ã®ã‚µãƒ¼ãƒãªã—ã§å®Ÿç¾ã™ã‚‹ã“ã¨ãŒå‡ºæ¥ãŸã€‚
</p>
<p>
ã•ã‚‰ã« <code>connectivitycheck.gstatic.com</code> ã®ãƒ‰ãƒ¡ã‚¤ãƒ³åã‚’ 127.0.0.1 ã«è§£æ±ºã•ã›ã¦ã‹ã¤ android ä¸Šã§ã‚µãƒ¼ãƒã‚’é§†å‹•ã•ã›ã‚Œã°ã€
ã€Œã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã¯åˆ©ç”¨ã§ãã¾ã›ã‚“ã€åˆ¤å®šæ©Ÿèƒ½ãŒå®Ÿè³ªç„¡åŠ¹åŒ–ã•ã‚Œã‚‹ã“ã¨ã‚’å¼•ãæ›ãˆã«
ç„¡ç·šã‚¢ã‚¯ã‚»ã‚¹ã‚’æŠ‘ãˆã‚‹ã“ã¨ã‚‚è€ƒãˆã‚‰ã‚Œã‚‹ãŒã€ã“ã‚Œã¯ã‚„ã£ã¦ã„ãªã„ã€‚
</p>
<h3>Reference</h3>
<ul>
<li><a href="http://androidxref.com/6.0.1_r10/xref/frameworks/base/services/core/java/com/android/server/connectivity/NetworkMonitor.java#429">com.android.server.connectivity.NetworkMonitor.EvaluatingState#processMessage()</a></li>
<li>"<a href="http://android.stackexchange.com/questions/123129/how-does-wifi-in-android-detect-if-the-device-has-to-sign-in-or-not">How does WiFi in android detect if the device has to sign in or not?</a>", Android Enthusiasts Stack Exchange</li>
<li>amythical, "<a href="http://amythical.tumblr.com/post/146341363847/bypass-captive-portal-for-android">Bypass captive portal for Android</a>", Notes, Jun 23 2016</li>
</ul>
<p>
ãã®ä»–ã€<code>connectivitycheck.gstatic.com</code> ã®ãƒ‰ãƒ¡ã‚¤ãƒ³åè§£æ±ºã‚’æ“ä½œã™ã‚‹ãŸã‚ã®
/etc/hosts ã®ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã¨ã—ã¦<a href="https://adaway.org/">AdAway</a>ã‚’ä½¿ç”¨ã—ãŸã€‚
</p>
</div><!-- post-content -->
<footer class="post-footer">
<div class="meta share">
Share:
<a rel="nofollow" href="https://twitter.com/intent/tweet?url=https://cat-in-136.github.io/2016/08/connectivitycheck-gstatic-com-android.html&amp;text=connectivitycheck.gstatic.com%20%E3%81%B8%E3%81%AE%20Android%20%E3%81%AE%E6%8E%A5%E7%B6%9A%E3%82%92%E8%AA%A4%E9%AD%94%E5%8C%96%E3%81%97%E3%81%A6%E3%81%BF%E3%82%8B%E3%83%86%E3%82%B9%E3%83%88+cat_in_136.blog()&amp;via=cat_in_136">Twitter</a>
<a rel="nofollow" href="https://www.facebook.com/sharer/sharer.php?u=https://cat-in-136.github.io/2016/08/connectivitycheck-gstatic-com-android.html">Facebook</a>
<a rel="nofollow" href="http://b.hatena.ne.jp/entry/cat-in-136.github.io/2016/08/connectivitycheck-gstatic-com-android.html">Hatena Bookmark</a>
<a rel="nofollow" href="http://www.addtoany.com/share_save?linkurl=https://cat-in-136.github.io/2016/08/connectivitycheck-gstatic-com-android.html&amp;linkname=connectivitycheck.gstatic.com%20%E3%81%B8%E3%81%AE%20Android%20%E3%81%AE%E6%8E%A5%E7%B6%9A%E3%82%92%E8%AA%A4%E9%AD%94%E5%8C%96%E3%81%97%E3%81%A6%E3%81%BF%E3%82%8B%E3%83%86%E3%82%B9%E3%83%88+cat_in_136.blog()">More via AddToAny...</a>
</div>
<div class="meta">
Source: <a href="https://github.com/cat-in-136/blog/blob/master/_posts/2016-08-15-connectivitycheck-gstatic-com-android.html" class="source-path">_posts/2016-08-15-connectivitycheck-gstatic-com-android.html</a>
(<a href="https://github.com/cat-in-136/blog/commits/master/_posts/2016-08-15-connectivitycheck-gstatic-com-android.html">History</a>)
</div>
</footer>
</article>
<nav class="post-nav wrap">
<div class="previous-post">
<a href="/2016/08/diff-between-firefox-490-beta-3-default.html" title="Diff between firefox 49.0 beta 3 default preference and firefox 48.0" rel="prev">&#x2190;Diff between firefox 49.0 beta 3 default preference and firefox 48.0</a>
</div>
<div class="next-post">
<a href="/2016/10/diff-between-firefox-500-beta-3-default.html" title="Diff between firefox 50.0 beta 3 default preference and firefox 49.0.1" rel="next">Diff between firefox 50.0 beta 3 default preference and firefox 49.0.1&#x2192;</a>
</div>
</nav>
<div id="disqus_thread"></div>
<script type="text/javascript">
var disqus_shortname = 'catin136blog';
(function() {
  var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
  dsq.src = 'https://' + disqus_shortname + '.disqus.com/embed.js';
  document.getElementsByTagName('head')[0].appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
<aside class="post-related">
<h2>Related Posts</h2>
<ul>
<li class="post-item">
<span class="post-date">2015-11-30</span>
<a class="post-link" href="/2015/11/redmine-scheduling-poll.html">ã€æ‹…å½“è€…ã•ã‚“å¿…è¦‹ã€‘ãƒ¡ãƒ³ãƒãƒ¼ã¿ã‚“ãªã§æ—¥ç¨‹èª¿æ•´ãŒã§ãã‚‹ã€ŒScheduling Pollã€ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ç™»å ´ï¼</a>
</li>
<li class="post-item">
<span class="post-date">2013-02-24</span>
<a class="post-link" href="/2013/02/netscape-communicator-4-beta-2-throbber.html">#Netscape Communicator 4 beta 2 Throbber â˜†å½¡â˜†å½¡ ğŸŒ™</a>
</li>
<li class="post-item">
<span class="post-date">2016-10-08</span>
<a class="post-link" href="/2016/10/optical-analysis-of-art-aquarium-water-bowl.html">ã‚¢ãƒ¼ãƒˆã‚¢ã‚¯ã‚¢ãƒªã‚¦ãƒ ã®æ°´ç›¤ã«ãŠã‘ã‚‹å…‰å­¦çš„è§£æã®ãƒ¡ãƒ¢</a>
</li>
<li class="post-item">
<span class="post-date">2014-12-29</span>
<a class="post-link" href="/2014/12/light-weight-font-android.html">Light ãª weight ãªæ—¥æœ¬èªãƒ•ã‚©ãƒ³ãƒˆã‚’ android ã«æŠ•å…¥</a>
</li>
<li class="post-item">
<span class="post-date">2014-05-12</span>
<a class="post-link" href="/2014/05/note-do-same-without.html">Note: do same without browser.tabs.closeButtons on Firefox 31+</a>
</li>
</ul>
</aside>
</div>
</div>
<footer class="site-footer">
<div class="wrap" role="contentinfo" itemscope="itemscope" itemtype="http://schema.org/WebSite">
<h2 class="footer-heading" itemprop="name">cat_in_136.blog()</h2>
<div class="column">
<p>
Copyright (C)
<span itemprop="publisher" itemscope="itemscope" itemtype="http://schema.org/Person">
<a href="https://twitter.com/cat_in_136/" itemprop="url"><span itemprop="name">@cat_in_136</span></a>
</span><br />
Content is available under a
<a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="license" itemprop="license" title="Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License">CC BY-NC-SA 4.0</a>
unless otherwise noted.
</p>
</div>
<nav class="column">
<ul>
<li>
<a href="https://twitter.com/cat_in_136/">Twitter @cat_in_136</a>
</li>
<li>
<a href="https://addons.mozilla.org/firefox/user/popoki-tom-cat_in_136/">Firefox Addons</a>,
<a href="https://addons.mozilla.org/firefox/addon/4420">Configuration Mania</a>
</li>
<li>
<a href="https://github.com/cat-in-136">Github</a>,
<a href="https://gist.github.com/cat-in-136">Gist</a>
</li>
<li>
<a href="https://bitbucket.org/cat_in_136/">Bitbucket</a>
</li>
<li>
<a href="https://www.flickr.com/photos/27992339@N00/">Flickr</a>
</li>
<li>
<a href="https://gnome-look.org/usermanager/search.php?username=catin136&amp;action=contents">GNOME-LOOK.org</a>
</li>
</ul>
</nav>
</div>
</footer>
</body>
</html>

